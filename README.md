# UpdateVersionInfo

Based on an idea of https://github.com/soltechinc/soltechxf/   
// http://stackoverflow.com/questions/27058172/xamarin-mobile-app-version-number-scheme-across-3-platforms

UpdateVersionInfo is basically a command line tool, that increments the revision number of a version.  

It was created to update synchronously all the versions of the different projects in a Xamarin.Forms solution, but since there UpdateVersionInfo evolved pretty much. We added more project types. Now (nearly) all the platforms covered by Xamarin.Forms are covered (UWP, Android, iOS, WPF, Mac, Nuggets). Yes, me missed Tizen. We don’t use it, so we hadn’t any use for it. Remember, UpdateVersionInfo is open source, so feel free to make a pull request for the Tizen implementation or anything else.



## project structure

You could ask the question, why the hell there are two projects for although one would have been fine. At the beginning, when we ([ChM40](https://github.com/ChM40) and me) took UpdateVersionInfo out of the box where it was sleeping for several years now, the idea was to integrate it to [VS-LittleHelpers](https://github.com/ZeProgFactory/VS-LittleHelpers). But finally nobody had the time to progress on this subject. So as the versioning question was more and more urgent we splitted the repository so that UpdateVersionInfo could live its own live.

But we still have in mind to reunite the two. So UpdateVersionInfo  contains basically the command-line UI whereas UpdateVersionInfo.Core is the operational part we'll try to integrate it to VisualStudio on Windows and Mac in the future ...

There are some administrational tools that scan the command line and global prepare the work. The real stuff is done in the "modules". There is one for every platform and they have all the same three functions:  ??? verify, getversion, update ??? ...

## modules

| state | module name     | platforme | file / ext | remarques |
|:--------------: | :-------: | :--------: | :--------: | ---------- |
|  OK   |  _VI_Helper     | "params" | VersionInfo.cs |  |
| --   | AppleHelper     | MacOS | Info.plist | TBD |
| OK | DeployProjectHelper | WPF, ... | .vdproj |  |
| ?   | DroidHelper     | Andoid | | |
| ?      | iOSHelper       | iOS | Info.plist |  |
| OK | NugetHelper     | Nugets | .Nuspec<br />.csproj |  |
| 50 %   | UWPHelper       | UWP | Package.AppxManifest |  |



## VersionInfo.cs

The version in `VersionInfo.cs` is the version we use as base when `-v=auto`

```
// Generated by UpdateVersionInfo 1.0.4
//# 1.1.10.10
//# 31.01.2020

using System;

namespace ZPF
{
   public static class VersionInfo
   {
      public static string sVersion { get => "1.1.10.10"; }
      public static Version Version { get => new Version(sVersion); }

      public static string BuildOn { get => DateTime.Now.ToString("31.01.2020"); }
      public static int RevisionNumber { get => Version.Revision; }
   }
}
```

You should not touch anything else than the version in the second line.  Everything after the comment block is generated.



## command line switches

```
UpdateVersionInfo - V1.0.0

  -?                         Shows help/usage information.
  -s                         silent/verbus
  -i                         Displays current version info
  -v, --major=VALUE          auto | A numeric major version number greater
                               than zero.
  -m, --minor=VALUE          A numeric minor number greater than zero.
  -b, --build=VALUE          A numeric build number greater than zero.
  -r, --revision=VALUE       A numeric revision number greater than zero.
  -p, --path=VALUE           scan | The path to a C# file to update with
                               version information.
  -a, --androidManifest=VALUE
                             The path to an android manifest file to update
                               with version information.
  -t, --touchPlist=VALUE     The path to an iOS plist file to update with
                               version information.
  -n, --nuspec=VALUE         The path to an Nuget definition file to update with
                               version information.
```



## version info

### command line
```
UpdateVersionInfo.exe -i -p=scan
```
### output
```
UpdateVersionInfo - V1.0.0

UWP   1.0.0.11
Droid 1.0.0.11
iOS   1.0
```



## version update

### command line
```
UpdateVersionInfo.exe -v=auto -p=scan
```
### output
```
UpdateVersionInfo - V1.0.0

UWP   1.0.0.15 --> 1.0.0.16
Droid 1.0.0.15 --> 1.0.0.16
iOS   1.0.0.15 --> 1.0.0.16
```

  

## "under construction" ...

N:\UpdateVersionInfo -v=auto 
    -p "D:\Software\Projects\audixis.Expertises\Expertises\Expertises\Expertises.UWP\Properties\AssemblyInfo.cs" 
    -a "D:\Software\Projects\audixis.Expertises\Expertises\Expertises\Expertises.Android\Properties\AndroidManifest.xml"

N:\UpdateVersionInfo -v=auto 
    -p "D:\Software\Projects\audixis.Expertises\Expertises\Expertises\Expertises.UWP\Properties\AssemblyInfo.cs" 
    -a "D:\Software\Projects\audixis.Expertises\Expertises\Expertises\Expertises.Droid\Properties\AndroidManifest.xml"

N:\UpdateVersionInfo -v=2.0.0.1 
    -p "D:\Software\Apps\ZeScanner\ZeScanner\ZeScanner\ZeScanner.UWP\Properties\AssemblyInfo.cs" 
    -t "D:\Software\Apps\ZeScanner\ZeScanner\ZeScanner\ZeScanner.iOS\Info.plist" 
    -a "D:\Software\Apps\ZeScanner\ZeScanner\ZeScanner\ZeScanner.Droid\Properties\AndroidManifest.xml"


<PreBuildEvent>$(SolutionDir)UpdateVersionInfo -v=auto -p "$(SolutionDir)StockAPPro.UWP\Properties\AssemblyInfo.cs" -a"$(ProjectDir)Properties\AndroidManifest.xml"</PreBuildEvent>


set UWP_Path="D:\Software\Apps\ZeScanner\ZeScanner\ZeScanner\ZeScanner.UWP\Properties\AssemblyInfo.cs"
set DroidPath="D:\Software\Apps\ZeScanner\ZeScanner\ZeScanner\ZeScanner.Droid\Properties\AndroidManifest.xml"

N:\UpdateVersionInfo -v=auto -p %UWP_Path% -a %DroidPath%



[assembly: AssemblyVersion("1.0.0.0")]
[assembly: System.Reflection.AssemblyVersion("[assembly: AssemblyVersion("1.0.0.1")]
